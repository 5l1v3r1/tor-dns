<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <title>DNS-based traffic correlation attacks</title>
  <link rel="stylesheet" type="text/css" href="../article.css"/>
</head>

<body>

<div class="centered">
<h1>DNS-based traffic correlation attacks</h1>

<a href="#overview">Overview</a>&nbsp;&nbsp;&bull;&nbsp;
<a href="#writing">Writing</a>&nbsp;&nbsp;&bull;&nbsp;
<a href="#code">Code</a>&nbsp;&nbsp;&bull;&nbsp;
<a href="#data">Data</a>&nbsp;&nbsp;&bull;&nbsp;
<a href="#contact">Contact</a>
</div>

<hr/>

<h2><a name="overview">Overview</a></h2>
<p>
<img alt="Overview" class="toprightimg" src="img/overview.png"/>
This research project investigates how the <i>domain name system</i> (DNS) can
be used to improve end-to-end correlation attacks on low-latency anonymity
networks such as <a href="https://www.torproject.org">Tor</a>.  Traditional
correlation attacks have focused on linking together TCP traffic between the
Tor client and its destination, but in practice there is more going on.
Before exit relays can establish a connection to the destination server, they
must resolve the domain name.  Depending on how the exit relay is configured,
the resulting DNS resolution traffic can traverse parts of the Internet that
the subsequent TCP connection does not traverse.  This exposure could
facilitate correlation attacks as an AS-level attacker is more likely to see
both &ldquo;ends&rdquo; of the Tor connection.  The diagram to the right
illustrates this problem.
</p>

<p>
In particular, we are interested in the following questions:
</p>
<ul>
	<li>Are single DNS requests sufficient for correlation attacks?</li>
	<li>How much easier do <a href="http://www.ohmygodel.com/publications/usersrouted-ccs13.pdf">traditional TCP-based correlation attacks</a> become when considering DNS? </li>
	<li>How are the resolvers of Tor exit relays configured?</li>
	<li>What can Tor exit relay operators do to improve the situation?</li>
</ul>

<h2><a name="writing">Writing</a></h2>
<p>
To date, our writing is limited to mailing list postings, a bug report, and a
poster that gives an overview of our preliminary research results.
</p>
<ul>
	<li>2016-05-15: Mailing list post &ldquo;<a href="https://lists.torproject.org/pipermail/tor-relays/2016-May/009255.html">Don&rsquo;t use Google&rsquo;s DNS server</a>&rdquo;</li>
    <li>2016-05-10: Bug report &ldquo;<a href="https://bugs.torproject.org/19025">Exit relays always return DNS TTL 60 to tor clients</a>&rdquo;</li>
	<li>2016-03-31: <a href="security-retreat-poster.pdf">Poster illustrating our preliminary research results</a></li>
	<li>2016-02-23: Mailing list post &ldquo;<a href="https://lists.torproject.org/pipermail/metrics-team/2016-February/000078.html">Exit relays&rsquo; DNS resolvers over time</a>&rdquo;</li>
</ul>

<h2><a name="code">Code</a></h2>
<p>
We have developed a tool,
<a href="https://github.com/NullHypothesis/ddptr"><tt>ddptr</tt></a>, which
stands for &ldquo;DNS Delegation Path Traceroute.&rdquo;  The tool determines
the DNS delegation path for a fully qualified domain name, and then runs UDP
traceroutes to all DNS servers on the path.  These traceroutes are then compared
to a TCP traceroute to the web server behind the same fully qualified domain
name.
</p>

<p>
<a href="img/baidu-web.png"><img alt="Baidu web path" class="toprightimg" src="img/baidu-web-small.png"/></a>
<a href="img/baidu-dns.png"><img alt="Baidu DNS path" class="toprightimg" src="img/baidu-dns-small.png"/></a>
Now imagine that our machine is trying to establish a TCP connection to
baidu.com.  How many autonomous systems will our network packets traverse?  The
two images to the right show an example.  (Click on the images for a larger
version.)  First, our machine has to resolve the domain before it can send
packets to the IP address.  The left image shows UDP traceroutes to all
DNS servers in the delegation path for &ldquo;baidu.com,&rdquo; namely
192.58.128.30, 192.43.172.30, and 202.108.22.220.  In total, these traceroutes
traversed 13 different autonomous systems, illustrated by the rectangular boxes.
The right image shows a TCP traceroute to &ldquo;baidu.com.&rdquo;  The
traceroute traversed at least four autonomous systems.  In this simple example,
we see that the DNS resolution process for baidu.com exposes our traffic to more
autonomous system than the actual TCP connection, provided we run our own DNS
resolver.
</p>

<p>
In addition to <tt>ddptr</tt> we maintain a
<a href="https://github.com/NullHypothesis/tor-dns-tools">GitHub repository</a>
that contains code snippets that we use to process the datasets that we will
eventually publish.  You can clone this git repository as follows:
</p>

<div class="centered">
<pre>
git clone https://github.com/NullHypothesis/tor-dns-tools.git
</pre>
</div>

<h2><a name="data">Data</a></h2>
<p>
We maintain a project page on the
<a href="https://osf.io/52nrp/">Open Science Framework</a>
to make available data fragments such as code patches.
</p>

<h3>Exit resolver dataset</h3>
<p>
The following dataset is a collection of .pcap files that we captured on the
authoritative DNS server for tor.nymity.ch.  We used this dataset to identify
the DNS resolvers of Tor exit relays.  The tarball contains a README file that
provides more details.
</p>
<ul>
	<li>
	<a href="data/tor-dns-pcaps.tar.xz">tor-dns-pcaps.tar.xz</a> (53.7 MiB)<br>
	SHA-1: <tt>4f2aa2f2e0f963cfc3c15237369d1714a5c44220</tt>
	</li>
</ul>

<h3>DNS exposure dataset</h3>
<p>
The following dataset contains the output of the tool
<a href="https://github.com/NullHypothesis/ddptr">ddptr</a>, which we ran
on a VPS operated by OVH.  The tarball contains a README file that provides more
details.
</p>
<ul>
	<li>
	<a href="data/dns-exposure.tar.xz">dns-exposure.tar.xz</a> (1.5 MiB) <br>
	SHA-1: <tt>24a5647998a5bb168c5080446061bead09492c62</tt>
	</li>
</ul>

<h3>DNS request number dataset</h3>
<p>
The following dataset contains the number of DNS requests per five minute
interval as recorded on our exit relay.  The dataset contains two files, one for
a
<a href="https://trac.torproject.org/projects/tor/wiki/doc/ReducedExitPolicy">reduced exit policy</a>,
and one for an exit policy containing only port 80 and 443.
</p>
<ul>
	<li>
	<a href="data/number-dns-requests.tar.xz">number-dns-requests.tar.xz</a> (19.2 KiB) <br/>
	SHA-1: <tt>daa0a5bf77f3425a3635f0e6fcd8f768ff2da1c6</tt>
	</li>
</ul>

<h3>Internet-scale simulation dataset</h3>
<p>
The following dataset contains data for the (<i>i</i>) fraction of compromised
streams and (<i>ii</i>) time until first compromise for 10,000 simulated Tor
users.  We generated the data with
<a href="https://github.com/torps/torps">TorPS</a> and by running traceroutes.
</p>
<ul>
	<li>
	<a href="data/internet-scale-simulation-data.tar.xz">internet-scale-simulation-data.tar.xz</a> (7.1 MiB) <br/>
	SHA-1: <tt>4289143cef7d6fc6d17e1155491b9689807b6216</tt>
	</li>
</ul>

<h2><a name="contact">Contact</a></h2>
<p>
At <a href="https://cs.princeton.edu/">Princeton University</a>:
</p>
<ul>
	<li><a href="https://cs.princeton.edu/~feamster/">Nick Feamster</a> &mdash; <img alt="Nick" src="img/nick.png"/></li>
	<li>Laura M. Roberts &mdash; <img alt="Laura" src="img/laura.png"/></li>
	<li><a href="https://cs.princeton.edu/~pwinter/">Philipp Winter</a> &mdash; <img alt="Philipp" src="img/philipp.png"/></li>
</ul>

<p>
At <a href="https://www.kau.se/en/cs">Karlstad University</a>:
</p>
<ul>
	<li><a href="https://www.kau.se/forskare/tobias-pulls">Tobias Pulls</a> &mdash; <img alt="Tobias" src="img/tobias.png"/></li>
</ul>

<p>
At <a href="https://www.kth.se/en/csc">KTH</a>:
</p>
<ul>
	<li><a href="https://www.csc.kth.se/~bgre/">Benjamin Greschbach</a> &mdash; <img alt="Benjamin" src="img/benjamin.png"/></li>
</ul>

<hr/>
<p>
<i>Last update: 2016-09-02</i>
</p>
</body>

</html>
