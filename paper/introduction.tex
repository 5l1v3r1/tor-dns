\section{Introduction}
\label{sec:introduction}

\begin{itemize}
	\item Tor's threat model excludes global passive adversaries, but they are a
		real-world threat~\cite{torstinks} that research has to quantify.

	\item Past research only focused on TCP flow between client and destination.
		Accompanying DNS requests were ignored because they are difficult to
		measure.

	\item DNS must not be ignored, because its distributed nature greatly
		increases path coverage, i.e., the number of ASes that are traversed by
		IP packets.

	\item As a result, past work might have underestimated the impact of
		network-level adversaries.

	\item In this paper, we quantify the threat.  Using
		exitmap~\cite{Winter2014b}, we are able to enumerate the DNS resolvers
		of exit relays.  We write a tool to quantify path exposure, and build
		practical attacks using Web site fingerprinting.
\end{itemize}

Our contribution is to answer a number of questions:
\begin{itemize}
	\item What advantage do relay-level and network-level adversaries gain when
		they consider DNS exposure?

	\item How many more autonomous systems are DNS requests exposed to, compared
		to end-to-end TCP flows?

	\item How should Tor exit relays be configured to mitigate this issue?
\end{itemize}

\begin{figure}[t]
	\centering
	\includegraphics[width=0.8\linewidth]{figures/attack-concept.pdf}
	\label{fig:overview}
	\caption{Past traffic correlation studies have focused on linking the TCP
		stream entering the Tor network to the one(s) exiting the network.  We
		show that an adversary can also link the associated DNS traffic, which
		can be exposed to many more ASs than the TCP stream.}
\end{figure}

\begin{figure}[t]
	\centering
	\includegraphics[width=\linewidth]{figures/as-exposure.pdf}
	\label{fig:as-exposure}
	\caption{Before a relay can establish a TCP connection to a web server, it
		has to resolve its domain name.  Ignoring caching, the relay begins by
		contacting a root server, which delegates the resolver to a TLD DNS
		server.  Finally, the relay contacts the authoritative DNS server that
		has an A record for the domain baidu.com.}
\end{figure}
